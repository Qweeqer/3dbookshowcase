{"mappings":"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","sources":["src/index.js"],"sourcesContent":["const Books = (function () {\n  const books = Array.from(\n      document.querySelectorAll('#bk-list > li > div.bk-book')\n    ),\n    booksCount = books.length;\n\n  function init() {\n    fetch(\n      'https://raw.githubusercontent.com/Qweeqer/3dbookshowcase/main/src/db/books/VelikaIstoriyaYkrajni.txt'\n    )\n      .then(response => response.text())\n      .then(data => {\n        const paragraphs = data.split('\\n');\n\n        books.forEach(function (book) {\n          const other = books.filter(b => b !== book),\n            parent = book.parentNode,\n            page = book.querySelector('div.bk-page'),\n            bookview = parent.querySelector('button.bk-bookview');\n          let current = 0;\n\n          // Remove old content\n          while (page.firstChild) {\n            page.firstChild.remove();\n          }\n\n          // Create and fill book content\n          const content = paragraphs.map((paragraph, i) => {\n            const div = document.createElement('div');\n            div.classList.add('bk-content');\n            if (i === 0) {\n              div.classList.add('bk-content-current');\n            }\n            div.textContent = paragraph;\n            page.appendChild(div);\n            return div;\n          });\n\n          // Initialize the dataset properties\n          book.dataset.opened = 'false';\n          book.dataset.flip = 'false';\n\n          parent\n            .querySelector('button.bk-bookback')\n            .addEventListener('click', function () {\n              bookview.classList.remove('bk-active');\n\n              if (book.dataset.flip === 'true') {\n                book.dataset.opened = 'false';\n                book.dataset.flip = 'false';\n\n                book.classList.remove('bk-viewback');\n                book.classList.add('bk-bookdefault');\n              } else {\n                book.dataset.opened = 'false';\n                book.dataset.flip = 'true';\n\n                book.classList.remove('bk-viewinside', 'bk-bookdefault');\n                book.classList.add('bk-viewback');\n              }\n            });\n\n          bookview.addEventListener('click', function () {\n            other.forEach(o => {\n              o.dataset.opened = 'false';\n              o.classList.remove('bk-viewinside');\n              o.parentNode.style.zIndex = 0;\n              o.parentNode\n                .querySelector('button.bk-bookview')\n                .classList.remove('bk-active');\n              if (!o.classList.contains('bk-viewback')) {\n                o.classList.add('bk-bookdefault');\n              }\n            });\n\n            if (book.dataset.opened === 'true') {\n              this.classList.remove('bk-active');\n              book.dataset.opened = 'false';\n              book.dataset.flip = 'false';\n\n              book.classList.remove('bk-viewinside');\n              book.classList.add('bk-bookdefault');\n            } else {\n              this.classList.add('bk-active');\n              book.dataset.opened = 'true';\n              book.dataset.flip = 'false';\n\n              book.classList.remove('bk-viewback', 'bk-bookdefault');\n              book.classList.add('bk-viewinside');\n              parent.style.zIndex = booksCount;\n              current = 0;\n              content.forEach(c => c.classList.remove('bk-content-current'));\n              content[current].classList.add('bk-content-current');\n            }\n          });\n\n          if (content.length > 1) {\n            const navPrev = document.createElement('span'),\n              navNext = document.createElement('span'),\n              pageInfo = document.createElement('span'); // Создаем новый элемент для информации о страницах\n\n            navPrev.classList.add('bk-page-prev');\n            navPrev.innerHTML = '&lt;';\n            navNext.classList.add('bk-page-next');\n            navNext.innerHTML = '&gt;';\n\n            pageInfo.classList.add('bk-page-info'); // Добавляем класс для нового элемента\n            pageInfo.innerHTML = `${current + 1} з ${content.length}`; // Заполняем его начальным контентом\n\n            const nav = document.createElement('nav');\n            nav.appendChild(navPrev);\n            nav.appendChild(pageInfo); // Добавляем новый элемент в навигацию\n            nav.appendChild(navNext);\n            page.appendChild(nav);\n\n            // Обновляем информацию о страницах при переключении страниц\n            const updatePageInfo = () => {\n              pageInfo.innerHTML = `${current + 1} з ${content.length}`;\n            };\n\n            navPrev.addEventListener('click', function (e) {\n              e.preventDefault();\n              if (current > 0) {\n                --current;\n                content.forEach(c => c.classList.remove('bk-content-current'));\n                content[current].classList.add('bk-content-current');\n              }\n              updatePageInfo(); // Обновляем информацию о страницах\n            });\n\n            navNext.addEventListener('click', function (e) {\n              e.preventDefault();\n              if (current < content.length - 1) {\n                ++current;\n                content.forEach(c => c.classList.remove('bk-content-current'));\n                content[current].classList.add('bk-content-current');\n              }\n              updatePageInfo(); // Обновляем информацию о страницах\n            });\n          }\n        });\n      })\n      .catch(err => {\n        console.error('Fetch error:', err);\n      });\n  }\n\n  return {\n    init: init,\n  };\n})();\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  Books.init();\n});\n"],"names":["books","booksCount","$b8f9b7833fa37166$var$Books","Array","from","document","querySelectorAll","length","init","fetch","then","response","text","data","paragraphs","split","forEach","book","other","filter","b","parent","parentNode","page","querySelector","bookview","current","firstChild","remove","content","map","paragraph","i","div","createElement","classList","add","textContent","appendChild","dataset","opened","flip","addEventListener","o","style","zIndex","contains","this","c","navPrev","navNext","pageInfo","innerHTML","concat","nav","updatePageInfo","e","preventDefault","catch","err","console","error"],"version":3,"file":"index.b5dd5903.js.map"}